
<!doctype html>
<html lang=en dir=ltr>
<head>
<meta charset=UTF-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<title>Settings - Community Server TovStudio</title>
<meta name=description content="Settings - Community Server TovStudio">
<link rel=preconnect href=https://fonts.googleapis.com>
<link rel=preconnect href=https://fonts.gstatic.com crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700&display=swap" rel=stylesheet>
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel=stylesheet>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css>
<script src=https://cdn.socket.io/4.6.0/socket.io.min.js></script>
<style>:root{--primary-color:#7e69ab;--primary-hover:#6b5b9a;--secondary-color:#9b87f5;--secondary-hover:#8b77f0;--dark-color:#1a1f2c;--darker-color:#151a26;--light-color:#f1f0fb;--text-color:#e5deff;--text-muted:#b8b4d1;--success-color:#48bb78;--warning-color:#f6ad55;--danger-color:#f56565;--gray-color:#a0aec0;--glass-bg:rgba(26, 31, 44, 0.85);--glass-border:rgba(155, 135, 245, 0.3);--glass-hover:rgba(155, 135, 245, 0.1);--status-open:#48bb78;--status-closed:#f56565;--status-on-hold:#f6ad55;--shadow-sm:0 2px 4px rgba(0, 0, 0, 0.1);--shadow-md:0 4px 6px rgba(0, 0, 0, 0.1);--shadow-lg:0 10px 15px rgba(0, 0, 0, 0.2);--border-radius:12px;--border-radius-sm:8px;--border-radius-lg:16px;--transition:all 0.3s cubic-bezier(0.4, 0, 0.2, 1);--transition-fast:all 0.2s cubic-bezier(0.4, 0, 0.2, 1)}*{margin:0;padding:0;box-sizing:border-box;font-family:Tajawal,Poppins,sans-serif}body{background:linear-gradient(135deg,var(--dark-color) 0,var(--darker-color) 100%);color:var(--text-color);min-height:100vh;overflow-x:hidden;background-size:cover;background-position:center;background-attachment:fixed}body::before{content:'';position:fixed;top:0;left:0;width:100%;height:100%;background:radial-gradient(circle at 20% 50%,rgba(126,105,171,.1) 0,transparent 50%),radial-gradient(circle at 80% 20%,rgba(155,135,245,.1) 0,transparent 50%),radial-gradient(circle at 40% 80%,rgba(126,105,171,.05) 0,transparent 50%);pointer-events:none;z-index:-1}.container{display:flex;min-height:100vh;position:relative}.sidebar{width:280px;background:var(--glass-bg);backdrop-filter:blur(20px);border-right:1px solid var(--glass-border);padding:0;display:flex;flex-direction:column;transition:var(--transition);z-index:100;box-shadow:var(--shadow-lg)}.sidebar.collapsed{width:80px}.logo-container{padding:24px 20px;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid var(--glass-border);background:linear-gradient(135deg,var(--glass-bg) 0,rgba(155,135,245,.1) 100%)}.logo{display:flex;align-items:center;transition:var(--transition)}.logo img{width:42px;height:42px;border-radius:50%;margin-right:12px;border:2px solid var(--primary-color);transition:var(--transition)}.logo img:hover{transform:scale(1.05);border-color:var(--secondary-color)}.logo-text{font-size:18px;font-weight:700;color:var(--text-color);white-space:nowrap;transition:var(--transition)}.menu-toggle{cursor:pointer;color:var(--text-color);background:0 0;border:none;font-size:20px;padding:8px;border-radius:var(--border-radius-sm);transition:var(--transition)}.menu-toggle:hover{background:var(--glass-hover);transform:scale(1.1)}.sidebar.collapsed .logo-text{opacity:0;transform:translateX(-20px)}.menu{list-style:none;padding:20px 0;margin:0;flex:1}.menu-item{padding:16px 24px;display:flex;align-items:center;cursor:pointer;color:var(--text-muted);transition:var(--transition);position:relative;margin:4px 12px;border-radius:var(--border-radius)}.menu-item::before{content:'';position:absolute;left:0;top:50%;transform:translateY(-50%);width:4px;height:0;background:var(--primary-color);border-radius:2px;transition:var(--transition)}.menu-item.active,.menu-item:hover{background:linear-gradient(135deg,var(--primary-color) 0,var(--secondary-color) 100%);color:#fff;transform:translateX(4px);box-shadow:var(--shadow-md)}.menu-item.active::before,.menu-item:hover::before{height:24px}.menu-item i{width:24px;text-align:center;margin-right:16px;font-size:18px;transition:var(--transition)}.menu-item:hover i{transform:scale(1.1)}.menu-text{font-weight:500;transition:var(--transition)}.sidebar.collapsed .menu-text{opacity:0;transform:translateX(-20px)}.sidebar-bottom-toggle{display:none;padding:16px 24px;margin:4px 12px;cursor:pointer;color:var(--text-muted);background:transparent;border:none;border-radius:var(--border-radius);transition:var(--transition);justify-content:flex-start;align-items:center;font-size:18px;position:relative}.sidebar-bottom-toggle::before{content:'';position:absolute;left:0;top:50%;transform:translateY(-50%);width:4px;height:0;background:var(--primary-color);border-radius:2px;transition:var(--transition)}.sidebar-bottom-toggle:hover{background:linear-gradient(135deg,var(--primary-color) 0,var(--secondary-color) 100%);color:#fff;transform:translateX(4px);box-shadow:var(--shadow-md)}.sidebar-bottom-toggle:hover::before{height:24px}.sidebar-bottom-toggle i{width:24px;text-align:center;margin-right:16px;font-size:18px;transition:var(--transition)}.sidebar-bottom-toggle:hover i{transform:scale(1.1)}.sidebar.collapsed .sidebar-bottom-toggle{display:flex}.sidebar.collapsed .menu-toggle{display:none}.main-content{flex:1;padding:32px;overflow-y:auto;position:relative}.header{display:flex;justify-content:space-between;align-items:center;margin-bottom:32px;padding:24px 32px;background:var(--glass-bg);backdrop-filter:blur(20px);border:1px solid var(--glass-border);border-radius:var(--border-radius-lg);box-shadow:var(--shadow-md)}#welcome-message{font-size:18px;font-weight:600;color:var(--text-color);opacity:0;transform:translateY(20px);animation:fadeInUp .6s ease-out .2s forwards}.section-title{font-size:28px;font-weight:700;margin-bottom:32px;color:var(--text-color);position:relative;opacity:0;transform:translateY(20px);animation:fadeInUp .6s ease-out .4s forwards}.section-title::after{content:'';position:absolute;bottom:-8px;left:0;width:60px;height:4px;background:linear-gradient(90deg,var(--primary-color),var(--secondary-color));border-radius:2px}.settings-section{background:var(--glass-bg);backdrop-filter:blur(20px);border:1px solid var(--glass-border);border-radius:var(--border-radius-lg);padding:32px;margin-bottom:32px;opacity:0;transform:translateY(20px);animation:fadeInUp .6s ease-out .6s forwards;box-shadow:var(--shadow-md)}.settings-section h3{margin-bottom:24px;color:var(--text-color);border-bottom:2px solid var(--primary-color);padding-bottom:12px;font-size:20px;font-weight:600}.form-group{margin-bottom:24px}.form-label{display:block;margin-bottom:8px;font-weight:600;color:var(--text-color);font-size:14px}.form-control{width:100%;padding:12px 16px;border:2px solid var(--glass-border);border-radius:var(--border-radius);background:var(--darker-color);color:var(--text-color);font-size:14px;transition:var(--transition)}.form-control:focus{outline:0;border-color:var(--primary-color);box-shadow:0 0 0 3px rgba(126,105,171,.2)}.preview-container{margin-top:16px;text-align:center}.preview-image{max-width:200px;max-height:150px;border-radius:var(--border-radius);border:2px solid var(--glass-border);box-shadow:var(--shadow-md)}.language-switch{display:flex;gap:12px;margin-bottom:24px}.lang-btn{background:var(--glass-bg);border:1px solid var(--glass-border);color:var(--text-color);padding:12px 24px;border-radius:var(--border-radius);cursor:pointer;transition:var(--transition);font-weight:500;position:relative;overflow:hidden}.lang-btn::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.1),transparent);transition:var(--transition)}.lang-btn:hover::before{left:100%}.lang-btn.active{background:linear-gradient(135deg,var(--primary-color),var(--secondary-color));border-color:var(--primary-color);color:#fff;box-shadow:var(--shadow-md)}.lang-btn:hover{background:var(--secondary-color);transform:translateY(-2px);box-shadow:var(--shadow-md)}.btn{padding:12px 24px;border-radius:var(--border-radius);border:none;font-weight:600;cursor:pointer;transition:var(--transition);display:inline-flex;align-items:center;gap:8px;font-size:14px;box-shadow:var(--shadow-sm);position:relative;overflow:hidden}.btn::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent);transition:var(--transition)}.btn:hover::before{left:100%}.btn-primary{background:linear-gradient(135deg,var(--primary-color),var(--secondary-color));color:#fff}.btn-primary:hover{transform:translateY(-2px);box-shadow:var(--shadow-lg)}.btn-secondary{background:var(--glass-bg);color:var(--text-color);border:1px solid var(--primary-color)}.btn-secondary:hover{background:var(--primary-color);transform:translateY(-2px);box-shadow:var(--shadow-md)}#toast-container{position:fixed;top:24px;right:24px;z-index:2000}.toast{display:flex;align-items:center;background:var(--glass-bg);backdrop-filter:blur(20px);border:1px solid var(--glass-border);border-radius:var(--border-radius-lg);padding:16px 24px;margin-bottom:12px;min-width:320px;max-width:480px;box-shadow:var(--shadow-lg);opacity:0;transform:translateX(100%);animation:slideInRight .4s ease-out forwards}.toast.removing{animation:slideOutRight .4s ease-out forwards}.toast-icon{font-size:20px;margin-right:16px;flex-shrink:0}.toast-content{flex:1}.toast-title{font-weight:600;font-size:15px;margin-bottom:4px}.toast-message{font-size:14px;color:var(--text-muted);line-height:1.4}.toast-close{background:0 0;border:none;color:var(--gray-color);font-size:18px;cursor:pointer;padding:4px;border-radius:4px;transition:var(--transition);margin-left:12px}.toast-close:hover{color:var(--text-color);background:var(--glass-hover)}@keyframes fadeInUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes slideInRight{from{opacity:0;transform:translateX(100%)}to{opacity:1;transform:translateX(0)}}@keyframes slideOutRight{from{opacity:1;transform:translateX(0)}to{opacity:0;transform:translateX(100%)}}@media (max-width:1024px){.main-content{padding:24px}.header{padding:20px 24px}.settings-section{padding:24px}}@media (max-width:768px){.container{flex-direction:column}.sidebar{width:100%;border-right:none;border-bottom:1px solid var(--glass-border);position:relative}.sidebar.collapsed{width:100%}.main-content{padding:16px}.header{flex-direction:column;gap:16px;padding:16px}.settings-section{padding:20px}.language-switch{flex-direction:column}.toast{min-width:280px;margin:0 16px 12px 16px}}</style>
<script src=https://cdn.gpteng.co/gptengineer.js type=module></script>
<script src=lang-config.js></script>
<script src=system-config.js></script>
</head>
<body>
<div class=container>
<div class=sidebar>
<div class=logo-container>
<div class=logo>
<img src="" id=logo-img alt=Logo>
<div class=logo-text data-lang-key=sidebar.title>Community Server TovStudio</div>
</div>
<button class=menu-toggle id=toggle-sidebar><i class="fas fa-bars"></i></button>
</div>
<ul class=menu>
<li class=menu-item onclick='window.location.href="/Home"'><i class="fas fa-home"></i><span class=menu-text>Home</span></li>
<li class=menu-item onclick='window.location.href="/"'><i class="fas fa-chart-bar"></i><span class=menu-text data-lang-key=sidebar.dashboard>Dashboard</span></li>
<li class=menu-item onclick='window.location.href="/Tickets"'><i class="fas fa-ticket"></i><span class=menu-text data-lang-key=sidebar.tickets>Tickets</span></li>
<li class=menu-item onclick='window.location.href="/Users"'><i class="fas fa-users"></i><span class=menu-text data-lang-key=sidebar.users>Users</span></li>
<li class=menu-item onclick='window.location.href="/Ratings"'><i class="fas fa-star"></i><span class=menu-text data-lang-key=sidebar.ratings>Ratings</span></li>
<li class=menu-item onclick='window.location.href="/Store"'><i class="fas fa-store"></i><span class=menu-text data-lang-key=sidebar.store>Store</span></li>
<li class="menu-item active" onclick='window.location.href="/Settings"'><i class="fas fa-cog"></i><span class=menu-text data-lang-key=sidebar.settings>Settings</span></li>
<li class=menu-item id=logout-btn><i class="fas fa-sign-out-alt"></i><span class=menu-text data-lang-key=sidebar.logout>Logout</span></li>
</ul>
<button class="sidebar-bottom-toggle" id="bottom-toggle-sidebar"><i class="fas fa-bars"></i></button>
</div>
<div class=main-content>
<div class=header>
<div id=welcome-message></div>
<button class="btn btn-primary" id=login-btn><i class="fas fa-sign-in-alt"></i> <span data-lang-key=header.login>Login</span></button>
</div>
<h2 class=section-title data-lang-key=settings.title>System Settings</h2>
<div class=settings-section>
<h3 data-lang-key=settings.languageSettings>Language Settings</h3>
<div class=language-switch>
<button class=lang-btn id=lang-en data-lang-key=settings.english>English</button>
<button class=lang-btn id=lang-ar data-lang-key=settings.arabic>Arabic</button>
</div>
</div>
<div class=settings-section>
<h3 data-lang-key=settings.interfaceSettings>Interface Settings</h3>
<div class=form-group>
<label class=form-label data-lang-key=settings.backgroundImage>Background Image</label>
<input type=url id=background-url class=form-control data-lang-placeholder=settings.backgroundImagePlaceholder>
<div class=preview-container>
<img id=background-preview class=preview-image src="" alt="Background Preview" style=display:none>
</div>
</div>
<div class=form-group>
<label class=form-label data-lang-key=settings.logoImage>Logo Image</label>
<input type=url id=logo-url class=form-control data-lang-placeholder=settings.logoImagePlaceholder>
<div class=preview-container>
<img id=logo-preview class=preview-image src="" alt="Logo Preview" style=display:none>
</div>
</div>
<div class=form-group>
<label class=form-label data-lang-key=settings.backgroundMusic>Background Music</label>
<input type=url id=music-url class=form-control data-lang-placeholder=settings.backgroundMusicPlaceholder>
</div>
<button class="btn btn-primary" id=save-settings-btn><i class="fas fa-save"></i> <span data-lang-key=settings.saveSettings>Save Settings</span></button>
</div>
</div>
</div>
<div id=toast-container></div>
<script>const sidebar=document.querySelector(".sidebar"),toggleSidebarBtn=document.getElementById("toggle-sidebar"),bottomToggleBtn=document.getElementById("bottom-toggle-sidebar"),loginBtn=document.getElementById("login-btn"),logoutBtn=document.getElementById("logout-btn");let currentUser=null,isAdmin=!1,settings={};const socket=io();function loadSidebarState(){const e=localStorage.getItem("sidebarCollapsed");return"true"===e}function saveSidebarState(e){localStorage.setItem("sidebarCollapsed",e.toString())}function toggleSidebar(){sidebar.classList.toggle("collapsed");const e=sidebar.classList.contains("collapsed");saveSidebarState(e)}function loadUserSettings(){try{const e=localStorage.getItem("userSettings");if(e)return settings=JSON.parse(e),applySettings(),void populateSettingsForm();fetch("/api/settings").then((e=>e.json())).then((e=>{settings=e,applySettings(),populateSettingsForm(),localStorage.setItem("userSettings",JSON.stringify(settings))})).catch((e=>{console.error("Error loading settings:",e)}))}catch(e){console.error("Error loading settings:",e)}}function checkSavedSession(e){fetch(`/auth/check-session?id=${e}`).then((e=>e.json())).then((e=>{e.authenticated?handleSuccessfulLogin(e.user,e.isAdmin):(localStorage.removeItem("ticketSystemUserId"),window.location.href="/auth/discord")})).catch((e=>{console.error("Error checking saved session:",e),localStorage.removeItem("ticketSystemUserId"),window.location.href="/auth/discord"}))}function checkAuthStatus(){fetch("/api/auth/status").then((e=>e.json())).then((e=>{e.authenticated?handleSuccessfulLogin(e.user,e.isAdmin):e.banned?(showToast(window.langConfig.getText("toast.banned"),window.langConfig.getText("toast.bannedMessage"),"error"),setTimeout((()=>{window.location.href="/auth/logout"}),3e3)):window.location.href="/auth/discord"})).catch((e=>{console.error("Error checking auth status:",e),window.location.href="/auth/discord"}))}function handleSuccessfulLogin(e,t){currentUser=e,isAdmin=t,localStorage.setItem("ticketSystemUserId",e.id),document.getElementById("welcome-message").textContent=`${window.langConfig.getText("header.welcome")}${e.global_name||e.username}`,loginBtn.style.display="none"}function applySettings(){settings.background&&(document.body.style.backgroundImage=`url('${settings.background}')`),settings.logo&&(document.getElementById("logo-img").src=settings.logo)}function populateSettingsForm(){if(settings.background){document.getElementById("background-url").value=settings.background;const e=document.getElementById("background-preview");e.src=settings.background,e.style.display="block"}if(settings.logo){document.getElementById("logo-url").value=settings.logo;const e=document.getElementById("logo-preview");e.src=settings.logo,e.style.display="block"}settings.music&&(document.getElementById("music-url").value=settings.music)}function showToast(e,t,n="info"){const s=document.getElementById("toast-container"),o=document.createElement("div");o.className="toast";let a="fa-info-circle";switch(n){case"success":a="fa-check-circle";break;case"error":a="fa-exclamation-circle";break;case"warning":a="fa-exclamation-triangle"}o.innerHTML=`\n          <i class="fas ${a} toast-icon"></i>\n          <div class="toast-content">\n            <div class="toast-title">${e}</div>\n            <div class="toast-message">${t}</div>\n          </div>\n          <button class="toast-close">&times;</button>\n        `,s.appendChild(o);const i=()=>{o.classList.add("removing"),setTimeout((()=>{o.parentNode&&o.remove()}),400)};setTimeout(i,5e3),o.querySelector(".toast-close").addEventListener("click",i)}function checkAuthOnLoad(){const e=localStorage.getItem("ticketSystemUserId");e?checkSavedSession(e):window.location.href="/auth/discord",loadUserSettings()}loginBtn.addEventListener("click",(()=>{window.location.href="/auth/discord"})),logoutBtn.addEventListener("click",(()=>{localStorage.removeItem("ticketSystemUserId"),window.location.href="/auth/logout"})),toggleSidebarBtn.addEventListener("click",toggleSidebar),bottomToggleBtn.addEventListener("click",toggleSidebar),document.getElementById("background-url").addEventListener("input",(function(){const e=document.getElementById("background-preview");this.value?(e.src=this.value,e.style.display="block"):e.style.display="none"})),document.getElementById("logo-url").addEventListener("input",(function(){const e=document.getElementById("logo-preview");this.value?(e.src=this.value,e.style.display="block"):e.style.display="none"})),document.getElementById("save-settings-btn").addEventListener("click",(function(){const e={background:document.getElementById("background-url").value,logo:document.getElementById("logo-url").value,music:document.getElementById("music-url").value};localStorage.setItem("userSettings",JSON.stringify(e)),settings=e,applySettings(),showToast(window.langConfig.getText("toast.success"),window.langConfig.getText("toast.settingsSaved"),"success")})),socket.on("settings_update",(e=>{localStorage.getItem("userSettings")||(settings=e,applySettings(),populateSettingsForm())})),document.addEventListener("DOMContentLoaded",(function(){if(loadSidebarState()&&sidebar.classList.add("collapsed"),window.langConfig){const e=localStorage.getItem("selectedLanguage");e&&window.langConfig.setLanguage(e),window.langConfig.updateUI();const t=document.getElementById("lang-en"),n=document.getElementById("lang-ar");t&&n&&("en"===window.langConfig.currentLang?(t.classList.add("active"),n.classList.remove("active")):(t.classList.remove("active"),n.classList.add("active")),t.addEventListener("click",(function(){window.langConfig.setLanguage("en")&&(localStorage.setItem("selectedLanguage","en"),t.classList.add("active"),n.classList.remove("active"),showToast(window.langConfig.getText("toast.success"),"Language changed to English","success"))})),n.addEventListener("click",(function(){window.langConfig.setLanguage("ar")&&(localStorage.setItem("selectedLanguage","ar"),n.classList.add("active"),t.classList.remove("active"),showToast(window.langConfig.getText("toast.success"),"تم تغيير اللغة إلى العربية","success"))})))}checkAuthOnLoad()}))</script>
</body>
</html>
