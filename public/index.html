
<!DOCTYPE html><html lang=en dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Community Server TovStudio</title><meta name=description content="Community Server TovStudio"><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700&display=swap" rel=stylesheet><link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css><script src=https://cdn.socket.io/4.6.0/socket.io.min.js></script><script src=https://cdn.jsdelivr.net/npm/chart.js></script><style>:root{--primary-color:#7e69ab;--primary-hover:#6b5b9a;--secondary-color:#9b87f5;--secondary-hover:#8b77f0;--dark-color:#1a1f2c;--darker-color:#151a26;--light-color:#f1f0fb;--text-color:#e5deff;--text-muted:#b8b4d1;--success-color:#48bb78;--warning-color:#f6ad55;--danger-color:#f56565;--gray-color:#a0aec0;--glass-bg:rgba(26, 31, 44, 0.85);--glass-border:rgba(155, 135, 245, 0.3);--glass-hover:rgba(155, 135, 245, 0.1);--status-open:#48bb78;--status-closed:#f56565;--status-on-hold:#f6ad55;--shadow-sm:0 2px 4px rgba(0, 0, 0, 0.1);--shadow-md:0 4px 6px rgba(0, 0, 0, 0.1);--shadow-lg:0 10px 15px rgba(0, 0, 0, 0.2);--border-radius:12px;--border-radius-sm:8px;--border-radius-lg:16px;--transition:all 0.3s cubic-bezier(0.4, 0, 0.2, 1);--transition-fast:all 0.2s cubic-bezier(0.4, 0, 0.2, 1)}*{margin:0;padding:0;box-sizing:border-box;font-family:Tajawal,Poppins,sans-serif}body{background:linear-gradient(135deg,var(--dark-color) 0,var(--darker-color) 100%);color:var(--text-color);min-height:100vh;overflow-x:hidden;background-size:cover;background-position:center;background-attachment:fixed}body::before{content:'';position:fixed;top:0;left:0;width:100%;height:100%;background:radial-gradient(circle at 20% 50%,rgba(126,105,171,.1) 0,transparent 50%),radial-gradient(circle at 80% 20%,rgba(155,135,245,.1) 0,transparent 50%),radial-gradient(circle at 40% 80%,rgba(126,105,171,.05) 0,transparent 50%);pointer-events:none;z-index:-1}.container{display:flex;min-height:100vh;position:relative}.sidebar{width:280px;background:var(--glass-bg);backdrop-filter:blur(20px);border-right:1px solid var(--glass-border);padding:0;display:flex;flex-direction:column;transition:var(--transition);z-index:100;box-shadow:var(--shadow-lg)}.sidebar.collapsed{width:80px}.logo-container{padding:24px 20px;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid var(--glass-border);background:linear-gradient(135deg,var(--glass-bg) 0,rgba(155,135,245,.1) 100%)}.logo{display:flex;align-items:center;transition:var(--transition)}.logo img{width:42px;height:42px;border-radius:50%;margin-right:12px;border:2px solid var(--primary-color);transition:var(--transition)}.logo img:hover{transform:scale(1.05);border-color:var(--secondary-color)}.logo-text{font-size:18px;font-weight:700;color:var(--text-color);white-space:nowrap;transition:var(--transition)}.menu-toggle{cursor:pointer;color:var(--text-color);background:0 0;border:none;font-size:20px;padding:8px;border-radius:var(--border-radius-sm);transition:var(--transition)}.menu-toggle:hover{background:var(--glass-hover);transform:scale(1.1)}.sidebar.collapsed .logo-text{opacity:0;transform:translateX(-20px)}.menu{list-style:none;padding:20px 0;margin:0;flex:1}.menu-item{padding:16px 24px;display:flex;align-items:center;cursor:pointer;color:var(--text-muted);transition:var(--transition);position:relative;margin:4px 12px;border-radius:var(--border-radius)}.menu-item::before{content:'';position:absolute;left:0;top:50%;transform:translateY(-50%);width:4px;height:0;background:var(--primary-color);border-radius:2px;transition:var(--transition)}.menu-item.active,.menu-item:hover{background:linear-gradient(135deg,var(--primary-color) 0,var(--secondary-color) 100%);color:#fff;transform:translateX(4px);box-shadow:var(--shadow-md)}.menu-item.active::before,.menu-item:hover::before{height:24px}.menu-item i{width:24px;text-align:center;margin-right:16px;font-size:18px;transition:var(--transition)}.menu-item:hover i{transform:scale(1.1)}.menu-text{font-weight:500;transition:var(--transition)}.sidebar.collapsed .menu-text{opacity:0;transform:translateX(-20px)}.sidebar-bottom-toggle{display:none;padding:16px 24px;margin:4px 12px;cursor:pointer;color:var(--text-muted);background:transparent;border:none;border-radius:var(--border-radius);transition:var(--transition);justify-content:flex-start;align-items:center;font-size:18px;position:relative}.sidebar-bottom-toggle::before{content:'';position:absolute;left:0;top:50%;transform:translateY(-50%);width:4px;height:0;background:var(--primary-color);border-radius:2px;transition:var(--transition)}.sidebar-bottom-toggle:hover{background:linear-gradient(135deg,var(--primary-color) 0,var(--secondary-color) 100%);color:#fff;transform:translateX(4px);box-shadow:var(--shadow-md)}.sidebar-bottom-toggle:hover::before{height:24px}.sidebar-bottom-toggle i{width:24px;text-align:center;margin-right:16px;font-size:18px;transition:var(--transition)}.sidebar-bottom-toggle:hover i{transform:scale(1.1)}.sidebar.collapsed .sidebar-bottom-toggle{display:flex}.sidebar.collapsed .menu-toggle{display:none}.main-content{flex:1;padding:32px;overflow-y:auto;position:relative}.header{display:flex;justify-content:space-between;align-items:center;margin-bottom:32px;padding:24px 32px;background:var(--glass-bg);backdrop-filter:blur(20px);border:1px solid var(--glass-border);border-radius:var(--border-radius-lg);box-shadow:var(--shadow-md)}#welcome-message{font-size:18px;font-weight:600;color:var(--text-color);opacity:0;transform:translateY(20px);animation:fadeInUp .6s ease-out .2s forwards}.welcome-container{text-align:center;padding:50px 20px;opacity:0;transform:translateY(20px);animation:fadeInUp .6s ease-out .4s forwards}.welcome-title{font-size:48px;font-weight:700;margin-bottom:20px;background:linear-gradient(45deg,var(--primary-color),var(--secondary-color));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.welcome-subtitle{font-size:20px;color:var(--gray-color);margin-bottom:30px}.btn{padding:12px 24px;border-radius:var(--border-radius);border:none;font-weight:600;cursor:pointer;transition:var(--transition);display:inline-flex;align-items:center;gap:8px;font-size:14px;box-shadow:var(--shadow-sm);position:relative;overflow:hidden}.btn::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent);transition:var(--transition)}.btn:hover::before{left:100%}.btn-primary{background:linear-gradient(135deg,var(--primary-color),var(--secondary-color));color:#fff}.btn-primary:hover{transform:translateY(-2px);box-shadow:var(--shadow-lg)}.btn-secondary{background:var(--glass-bg);color:var(--text-color);border:1px solid var(--primary-color)}.btn-secondary:hover{background:var(--primary-color);transform:translateY(-2px);box-shadow:var(--shadow-md)}.btn-lg{padding:15px 30px;font-size:18px}#toast-container{position:fixed;top:24px;right:24px;z-index:2000}.toast{display:flex;align-items:center;background:var(--glass-bg);backdrop-filter:blur(20px);border:1px solid var(--glass-border);border-radius:var(--border-radius-lg);padding:16px 24px;margin-bottom:12px;min-width:320px;max-width:480px;box-shadow:var(--shadow-lg);opacity:0;transform:translateX(100%);animation:slideInRight .4s ease-out forwards}.toast.removing{animation:slideOutRight .4s ease-out forwards}.toast-icon{font-size:20px;margin-right:16px;flex-shrink:0}.toast-content{flex:1}.toast-title{font-weight:600;font-size:15px;margin-bottom:4px}.toast-message{font-size:14px;color:var(--text-muted);line-height:1.4}.toast-close{background:0 0;border:none;color:var(--gray-color);font-size:18px;cursor:pointer;padding:4px;border-radius:4px;transition:var(--transition);margin-left:12px}.toast-close:hover{color:var(--text-color);background:var(--glass-hover)}.stats-overview{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:24px;margin-bottom:32px}.stat-card{background:var(--glass-bg);backdrop-filter:blur(20px);border:1px solid var(--glass-border);border-radius:var(--border-radius-lg);padding:24px;box-shadow:var(--shadow-md);transition:var(--transition)}.stat-card:hover{transform:translateY(-4px);box-shadow:var(--shadow-lg)}.stat-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px}.stat-title{font-size:14px;font-weight:500;color:var(--text-muted);text-transform:uppercase;letter-spacing:.5px}.stat-icon{width:48px;height:48px;border-radius:var(--border-radius);display:flex;align-items:center;justify-content:center;font-size:24px}.stat-value{font-size:36px;font-weight:700;color:var(--text-color);margin-bottom:8px}.stat-subtitle{font-size:12px;color:var(--text-muted)}.charts-section{margin-bottom:32px}.section-title{font-size:24px;font-weight:700;color:var(--text-color);margin-bottom:24px;text-align:center}.charts-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(400px,1fr));gap:24px}.chart-card{background:var(--glass-bg);backdrop-filter:blur(20px);border:1px solid var(--glass-border);border-radius:var(--border-radius-lg);padding:24px;box-shadow:var(--shadow-md)}.chart-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:20px}.chart-title{font-size:18px;font-weight:600;color:var(--text-color)}.chart-container{position:relative;height:300px}.loading{text-align:center;color:var(--text-muted);padding:40px}.messages{background:linear-gradient(135deg,var(--success-color),#38a169)}.joins{background:linear-gradient(135deg,var(--primary-color),var(--secondary-color))}.members{background:linear-gradient(135deg,var(--warning-color),#ed8936)}.filter-buttons{text-align:center;margin:20px 0;padding:20px;background:var(--glass-bg);backdrop-filter:blur(20px);border:1px solid var(--glass-border);border-radius:var(--border-radius-lg)}.filter-active{background:linear-gradient(135deg,var(--primary-color),var(--secondary-color));color:#fff!important}.hidden{display:none}@keyframes fadeInUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes slideInRight{from{opacity:0;transform:translateX(100%)}to{opacity:1;transform:translateX(0)}}@keyframes slideOutRight{from{opacity:1;transform:translateX(0)}to{opacity:0;transform:translateX(100%)}}@media (max-width:1024px){.main-content{padding:24px}.header{padding:20px 24px}.charts-grid{grid-template-columns:1fr}}@media (max-width:768px){.container{flex-direction:column}.sidebar{width:100%;border-right:none;border-bottom:1px solid var(--glass-border);position:relative}.sidebar.collapsed{width:100%}.main-content{padding:16px}.header{flex-direction:column;gap:16px;padding:16px}.welcome-title{font-size:32px}.welcome-subtitle{font-size:16px}.stats-overview{grid-template-columns:1fr}.charts-grid{grid-template-columns:1fr}}</style><script src=https://cdn.gpteng.co/gptengineer.js type=module></script><script src=index-auth.js></script><script src=lang-config.js></script><script src=system-config.js></script></head><body><div class=container><div class=sidebar><div class=logo-container><div class=logo><img src="" id=logo-img alt=Logo><div class=logo-text data-lang-key=sidebar.title>Community Server TovStudio</div></div><button class=menu-toggle id=toggle-sidebar><i class="fas fa-bars"></i></button></div><ul class=menu><li class=menu-item onclick='window.location.href="/Home"'><i class="fas fa-home"></i><span class=menu-text data-lang-key=sidebar.home>Home</span></li><li class="menu-item active" onclick='window.location.href="/"'><i class="fas fa-chart-bar"></i><span class=menu-text data-lang-key=sidebar.dashboard>Dashboard</span></li><li class=menu-item onclick='window.location.href="/Tickets"'><i class="fas fa-ticket"></i><span class=menu-text data-lang-key=sidebar.tickets>Tickets</span></li><li class=menu-item onclick='window.location.href="/Users"'><i class="fas fa-users"></i><span class=menu-text data-lang-key=sidebar.users>Users</span></li><li class=menu-item onclick='window.location.href="/Ratings"'><i class="fas fa-star"></i><span class=menu-text data-lang-key=sidebar.ratings>Ratings</span></li><li class=menu-item onclick='window.location.href="/Store"'><i class="fas fa-store"></i><span class=menu-text data-lang-key=sidebar.store>Store</span></li><li class=menu-item onclick='window.location.href="/Settings"'><i class="fas fa-cog"></i><span class=menu-text data-lang-key=sidebar.settings>Settings</span></li><li class=menu-item id=logout-btn><i class="fas fa-sign-out-alt"></i><span class=menu-text data-lang-key=sidebar.logout>Logout</span></li></ul><button class="sidebar-bottom-toggle" id="bottom-toggle-sidebar"><i class="fas fa-bars"></i></button></div><div class=main-content><div class=header><div id=welcome-message></div><button class="btn btn-primary" id=login-btn><i class="fas fa-sign-in-alt"></i> <span data-lang-key=header.login>Login</span></button></div><div id=dashboard-content class=hidden><h2 class=section-title data-lang-key=dashboard.title>Discord Statistics - Overview</h2><div class=stats-overview><div class=stat-card><div class=stat-header><span class=stat-title data-lang-key=dashboard.newMessages>New Messages</span><div class="stat-icon messages"><i class="fas fa-comments"></i></div></div><div class=stat-value id=messages-today>0</div><div class=stat-subtitle data-lang-key=dashboard.last24h>in the last 24h</div></div><div class=stat-card><div class=stat-header><span class=stat-title data-lang-key=dashboard.joinsLeaves>Joins/Leaves</span><div class="stat-icon joins"><i class="fas fa-user-plus"></i></div></div><div class=stat-value><span id=joins-today>0</span>/<span id=leaves-today>0</span></div><div class=stat-subtitle data-lang-key=dashboard.last24h>in the last 24h</div></div><div class=stat-card><div class=stat-header><span class=stat-title data-lang-key=dashboard.totalMembers>Total Members</span><div class="stat-icon members"><i class="fas fa-users"></i></div></div><div class=stat-value id=total-members>0</div><div class=stat-subtitle data-lang-key=dashboard.currentCount>Current count</div></div></div><div class=filter-buttons><span style="margin-right: 10px;" data-lang-key=dashboard.filterBy>Filter by:</span> <button class="btn btn-secondary filter-active" id=filter-24h onclick="filterCharts('24h')" data-lang-key=dashboard.last24h>Last 24h</button> <button class="btn btn-secondary" id=filter-7d onclick="filterCharts('7d')" data-lang-key=dashboard.last7days>Last 7 days</button> <button class="btn btn-secondary" id=filter-1m onclick="filterCharts('1m')" data-lang-key=dashboard.lastMonth>Last month</button> <button class="btn btn-secondary" id=filter-1y onclick="filterCharts('1y')" data-lang-key=dashboard.lastYear>Last year</button></div><h3 class=section-title data-lang-key=dashboard.chartsTitle>Charts over Last 7 Days</h3><div class=charts-grid><div class=chart-card><div class=chart-header><h4 class=chart-title data-lang-key=dashboard.joinsLeavesChart>Joins / Leaves</h4></div><div class=chart-container><canvas id=joinsLeavesChart></canvas></div></div><div class=chart-card><div class=chart-header><h4 class=chart-title data-lang-key=dashboard.memberflowChart>Memberflow</h4></div><div class=chart-container><canvas id=memberflowChart></canvas></div></div><div class=chart-card><div class=chart-header><h4 class=chart-title data-lang-key=dashboard.messagesChart>Number of messages (excl. Bots)</h4></div><div class=chart-container><canvas id=messagesChart></canvas></div></div></div><h2 class=section-title style="margin-top: 40px;" data-lang-key=dashboard.socialHighlights>Social Network Highlights</h2><div class=stats-overview><div class=stat-card><div class=stat-header><span class=stat-title data-lang-key=dashboard.topLikedPost>Most Liked Post</span><div class=stat-icon style="background: #ff69b4;"><i class="fas fa-heart"></i></div></div><div class=stat-value id=top-liked-post-value>0 likes</div><div class=stat-subtitle id=top-liked-post-user>by: No data</div><p style="font-size: 14px; color: var(--text-muted); margin-top: 8px;" id=top-liked-post-content>No posts available</p></div><div class=stat-card><div class=stat-header><span class=stat-title data-lang-key=dashboard.topViewedVideo>Most Viewed Video</span><div class=stat-icon style="background: #1e90ff;"><i class="fas fa-video"></i></div></div><div class=stat-value id=top-viewed-video-views>0 views</div><div class=stat-subtitle id=top-viewed-video-title>No videos</div><p style="font-size: 14px; color: var(--text-muted); margin-top: 8px;" id=top-viewed-video-uploader>by: No data</p></div><div class=stat-card><div class=stat-header><span class=stat-title data-lang-key=dashboard.mostActiveUser>Most Active User</span><div class=stat-icon style="background: #32cd32;"><i class="fas fa-fire"></i></div></div><div class=stat-value id=most-active-user-name>No data</div><div class=stat-subtitle id=most-active-user-posts>0 posts</div><p style="font-size: 14px; color: var(--text-muted); margin-top: 8px;" data-lang-key=dashboard.mostActiveUserDesc>Most interactive in social network feed.</p></div></div></div><div class=welcome-container id=welcome-section><h1 class=welcome-title data-lang-key=welcome.title>Welcome to the Community Server TovStudio</h1><p class=welcome-subtitle data-lang-key=welcome.subtitle>Select a section from the sidebar to get started</p><div style=margin-top:40px><button class="btn btn-primary btn-lg" onclick='window.location.href="/Home"'><i class="fas fa-home"></i> <span data-lang-key=welcome.goToHome>Go to Home</span></button> <button class="btn btn-secondary btn-lg" onclick='window.location.href="/Tickets"' style=margin-left:16px;><i class="fas fa-ticket"></i> <span data-lang-key=welcome.goToTickets>Go to Tickets</span></button></div></div></div></div><div id=toast-container></div><audio id=background-music loop></audio><audio id=notification-sound src=https://files.catbox.moe/wzac7y></audio><audio id=rating-sound src=https://files.catbox.moe/ghzmdo.mp3></audio><audio id=message-sound src=https://files.catbox.moe/a6vhkl.mp3></audio><script>const sidebar=document.querySelector(".sidebar"),toggleSidebarBtn=document.getElementById("toggle-sidebar"),bottomToggleBtn=document.getElementById("bottom-toggle-sidebar"),loginBtn=document.getElementById("login-btn"),logoutBtn=document.getElementById("logout-btn"),backgroundMusic=document.getElementById("background-music"),dashboardContent=document.getElementById("dashboard-content"),welcomeSection=document.getElementById("welcome-section");let currentUser=null,isAdmin=!1,settings={},discordStats={},socialStats={},charts={},currentFilter='24h';function loadSidebarState(){const e=localStorage.getItem("sidebarCollapsed");return"true"===e}function saveSidebarState(e){localStorage.setItem("sidebarCollapsed",e.toString())}function toggleSidebar(){sidebar.classList.toggle("collapsed");const e=sidebar.classList.contains("collapsed");saveSidebarState(e)}function loadUserSettings(){try{const e=localStorage.getItem("userSettings");if(e)return settings=JSON.parse(e),void applySettings();fetch("/api/settings").then(e=>e.json()).then(e=>{settings=e,applySettings(),localStorage.setItem("userSettings",JSON.stringify(settings))}).catch(e=>{console.error("Error loading settings:",e)})}catch(e){console.error("Error loading settings:",e)}}function checkSavedSession(e){fetch(`/auth/check-session?id=${e}`).then(e=>e.json()).then(e=>{e.authenticated?handleSuccessfulLogin(e.user,e.isAdmin):(localStorage.removeItem("ticketSystemUserId"),window.location.href="/auth/discord")}).catch(e=>{console.error("Error checking saved session:",e),localStorage.removeItem("ticketSystemUserId"),window.location.href="/auth/discord"})}function checkAuthStatus(){fetch("/api/auth/status").then(e=>e.json()).then(e=>{e.authenticated?handleSuccessfulLogin(e.user,e.isAdmin):e.banned?(showToast(window.langConfig.getText("toast.banned"),window.langConfig.getText("toast.bannedMessage"),"error"),setTimeout(()=>{window.location.href="/auth/logout"},3e3)):window.location.href="/auth/discord"}).catch(e=>{console.error("Error checking auth status:",e),window.location.href="/auth/discord"})}function handleSuccessfulLogin(e,t){currentUser=e,isAdmin=t,localStorage.setItem("ticketSystemUserId",e.id),document.getElementById("welcome-message").textContent=`${window.langConfig.getText("header.welcome")}${e.global_name||e.username}`,loginBtn.style.display="none",welcomeSection.classList.add("hidden"),dashboardContent.classList.remove("hidden"),loadDiscordStats(),loadSocialStats()}function handleLoggedOut(){window.location.href="/auth/discord"}function applySettings(){settings.background&&(document.body.style.backgroundImage=`url('${settings.background}')`),settings.logo&&(document.getElementById("logo-img").src=settings.logo),settings.music&&(backgroundMusic.src=settings.music,document.addEventListener("click",()=>{backgroundMusic.play().catch(()=>{})},{once:!0}))}function showToast(e,t,n="info"){const s=document.getElementById("toast-container"),a=document.createElement("div");a.className="toast";let c="fa-info-circle";switch(n){case"success":c="fa-check-circle";break;case"error":c="fa-exclamation-circle";break;case"warning":c="fa-exclamation-triangle"}a.innerHTML=`<i class="fas ${c} toast-icon"></i><div class="toast-content"><div class="toast-title">${e}</div><div class="toast-message">${t}</div></div><button class="toast-close">&times;</button>`,s.appendChild(a);const i=()=>{a.classList.add("removing"),setTimeout(()=>{a.parentNode&&a.remove()},400)};setTimeout(i,5e3),a.querySelector(".toast-close").addEventListener("click",i)}function loadDiscordStats(){fetch(`/api/discord/stats?range=${currentFilter}`).then(e=>e.json()).then(e=>{discordStats=e,updateStatsDisplay(),createCharts()}).catch(e=>{console.error("Error loading Discord stats:",e)})}function loadSocialStats(){fetch("/api/social/highlights").then(e=>e.json()).then(e=>{socialStats=e,updateSocialStatsDisplay()}).catch(e=>{console.error("Error loading social stats:",e)})}function updateStatsDisplay(){if(!discordStats.today)return;document.getElementById("messages-today").textContent=discordStats.today.messages_count||0,document.getElementById("joins-today").textContent=discordStats.today.joins_count||0,document.getElementById("leaves-today").textContent=discordStats.today.leaves_count||0,document.getElementById("total-members").textContent=discordStats.today.total_members||0}function updateSocialStatsDisplay(){if(socialStats.topLikedPost){document.getElementById("top-liked-post-value").textContent=`${socialStats.topLikedPost.likes_count} likes`;document.getElementById("top-liked-post-user").textContent=`by: @${socialStats.topLikedPost.username}`;document.getElementById("top-liked-post-content").textContent=socialStats.topLikedPost.content.substring(0,80)+(socialStats.topLikedPost.content.length>80?"...":"");}if(socialStats.topViewedVideo){document.getElementById("top-viewed-video-views").textContent=`${socialStats.topViewedVideo.views_count} views`;document.getElementById("top-viewed-video-title").textContent=socialStats.topViewedVideo.content.substring(0,50)+(socialStats.topViewedVideo.content.length>50?"...":"");document.getElementById("top-viewed-video-uploader").textContent=`by: @${socialStats.topViewedVideo.username}`;}if(socialStats.mostActiveUser){document.getElementById("most-active-user-name").textContent=`@${socialStats.mostActiveUser.username}`;document.getElementById("most-active-user-posts").textContent=`${socialStats.mostActiveUser.posts_count} posts`;}}function filterCharts(range){currentFilter=range;document.querySelectorAll('.filter-buttons .btn').forEach(btn=>{btn.classList.remove('filter-active')});document.getElementById(`filter-${range}`).classList.add('filter-active');showToast(`Filtering charts for: ${range}`,`Selected range: ${range}`);loadDiscordStats();}function createCharts(){const chartData=discordStats.chartData||discordStats.last7Days;if(chartData&&chartData.length>0){createJoinsLeavesChart(chartData);createMemberflowChart(chartData);createMessagesChart(chartData);}}function createJoinsLeavesChart(data){const e=document.getElementById("joinsLeavesChart");if(!e)return;const t=e.getContext("2d"),n=data.slice().reverse(),s=n.map(e=>e.date),a=n.map(e=>e.joins_count||0),c=n.map(e=>e.leaves_count||0);charts.joinsLeaves&&charts.joinsLeaves.destroy(),charts.joinsLeaves=new Chart(t,{type:"line",data:{labels:s,datasets:[{label:window.langConfig.getText("dashboard.joins"),data:a,borderColor:"#48bb78",backgroundColor:"rgba(72, 187, 120, 0.1)",fill:!0,tension:.4},{label:window.langConfig.getText("dashboard.leaves"),data:c,borderColor:"#f56565",backgroundColor:"rgba(245, 101, 101, 0.1)",fill:!0,tension:.4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"#e5deff"}}},scales:{x:{ticks:{color:"#b8b4d1"},grid:{color:"rgba(155, 135, 245, 0.1)"}},y:{ticks:{color:"#b8b4d1"},grid:{color:"rgba(155, 135, 245, 0.1)"}}},elements:{point:{radius:4,hoverRadius:6}}}})}function createMemberflowChart(data){const e=document.getElementById("memberflowChart");if(!e)return;const t=e.getContext("2d"),n=data.slice().reverse(),s=n.map(e=>e.date),a=n.map(e=>e.total_members||0);charts.memberflow&&charts.memberflow.destroy(),charts.memberflow=new Chart(t,{type:"line",data:{labels:s,datasets:[{label:window.langConfig.getText("dashboard.totalMembers"),data:a,borderColor:"#9b87f5",backgroundColor:"rgba(155, 135, 245, 0.1)",fill:!0,tension:.4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"#e5deff"}}},scales:{x:{ticks:{color:"#b8b4d1"},grid:{color:"rgba(155, 135, 245, 0.1)"}},y:{ticks:{color:"#b8b4d1"},grid:{color:"rgba(155, 135, 245, 0.1)"}}},elements:{point:{radius:4,hoverRadius:6}}}})}function createMessagesChart(data){const e=document.getElementById("messagesChart");if(!e)return;const t=e.getContext("2d"),n=data.slice().reverse(),s=n.map(e=>e.date),a=n.map(e=>e.messages_count||0);charts.messages&&charts.messages.destroy(),charts.messages=new Chart(t,{type:"bar",data:{labels:s,datasets:[{label:window.langConfig.getText("dashboard.messageCount"),data:a,backgroundColor:"rgba(72, 187, 120, 0.8)",borderColor:"#48bb78",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"#e5deff"}}},scales:{x:{ticks:{color:"#b8b4d1"},grid:{color:"rgba(155, 135, 245, 0.1)"}},y:{ticks:{color:"#b8b4d1"},grid:{color:"rgba(155, 135, 245, 0.1)"}}},elements:{bar:{borderRadius:4}}}})}function checkAuthOnLoad(){const e=localStorage.getItem("ticketSystemUserId");e?checkSavedSession(e):window.location.href="/auth/discord",loadUserSettings()}loginBtn.addEventListener("click",()=>{window.location.href="/auth/discord"}),logoutBtn.addEventListener("click",()=>{localStorage.removeItem("ticketSystemUserId"),window.location.href="/auth/logout"}),toggleSidebarBtn.addEventListener("click",toggleSidebar),bottomToggleBtn.addEventListener("click",toggleSidebar),document.addEventListener("DOMContentLoaded",function(){if(loadSidebarState()&&sidebar.classList.add("collapsed"),window.langConfig){const e=localStorage.getItem("selectedLanguage");e&&window.langConfig.setLanguage(e),window.langConfig.updateUI()}window.systemConfig&&console.log("System config loaded"),checkAuthOnLoad()}),setInterval(()=>{currentUser&&(loadDiscordStats(),loadSocialStats())},3e5)</script></body></html>
